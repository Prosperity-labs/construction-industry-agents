sequenceDiagram
    participant Arch as ðŸ¢ Projektant
    participant Revit as ðŸ—ï¸ Revit
    participant User as ðŸ‘¤ Contractor
    participant Web as ðŸŒ Web Interface
    participant Orch as ðŸŽ¯ Orchestrator
    participant A1 as ðŸ“Š Excel Parser
    participant A2 as ðŸ­ Supplier Mapper
    participant A3 as ðŸ“¤ Communicator
    participant A4 as ðŸ“¥ Response Parser
    participant A5 as ðŸ§® Calculator
    participant A6 as ðŸ“„ Generator
    participant DB as ðŸ’¾ Database
    participant Email as ðŸ“§ Email System
    
    Note over Arch,Revit: UPSTREAM PROCESS
    Arch->>Revit: Create 3D model
    Arch->>Revit: Add custom parameters<br/>â€¢ Description<br/>â€¢ Unit, Quantity<br/>â€¢ Specifications
    Revit->>Revit: Generate Schedule
    Revit->>User: Export Excel file
    
    Note over User,Email: AUTOMATED QUOTE PROCESS
    User->>Web: Upload Excel from Revit
    Web->>Orch: Start processing
    Orch->>A1: Parse Revit Excel
    
    Note over A1: âœ… IMPLEMENTED<br/>Reads Revit schedules<br/>Handles custom parameters<br/>Categorizes items<br/>OpenAI enhanced
    A1->>DB: Store parsed items
    A1->>Orch: Items extracted âœ…
    
    Orch->>A2: Map suppliers
    Note over A2: ðŸ”§ TO BUILD<br/>Find best suppliers<br/>for each category
    A2->>DB: Query supplier database
    A2->>Orch: Suppliers mapped âœ…
    
    Orch->>A3: Send queries
    Note over A3: ðŸ”§ TO BUILD<br/>Email + API calls<br/>Parallel processing
    
    par Send to multiple suppliers
        A3->>Email: Email to Supplier 1
        A3->>Email: Email to Supplier 2
        A3->>Email: API call to Supplier 3
    end
    
    Note over A3,Email: Wait for responses<br/>15-25 minutes
    
    Email-->>A4: Responses received
    A4->>A4: Parse emails & PDFs
    Note over A4: ðŸ”§ TO BUILD<br/>OCR processing<br/>Price extraction
    A4->>DB: Store all prices
    A4->>Orch: Prices collected âœ…
    
    Orch->>A5: Calculate quote
    Note over A5: ðŸ”§ TO BUILD<br/>Best price selection<br/>Margin calculation
    A5->>DB: Store final calculations
    A5->>Orch: Quote calculated âœ…
    
    Orch->>A6: Generate documents
    Note over A6: ðŸ”§ TO BUILD<br/>PDF generation<br/>Excel export
    A6->>Web: Return PDF & Excel
    Web->>User: Download ready! ðŸŽ‰
    
    rect rgb(200, 230, 200)
        Note over User,DB: TOTAL TIME: 30 MINUTES<br/>SUCCESS RATE: 95%+
    end